<main>
  <div class="row">
    <div class="col-md-12 col-lg-4">
      <h1 class="mb-4">Import Report</h1>
      <!-- <h5>Step 1/2: Please select a file to import</h5> -->
      <mat-card class="import-card">
        <form [formGroup]="reportForm">
          <!-- <p>
              <label for="term">Term *</label>
            </p> -->
          <mat-form-field>
            <mat-label>Term</mat-label>
            <mat-select disableOptionCentering panelClass="dropDown-seasons-panel" id="term" formControlName="term" (selectionChange)="changeTerm()">
              <mat-option *ngFor="let option of termOptions" [value]="option">
                {{option.termName}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field>
            <mat-label>Month</mat-label>
            <mat-select disableOptionCentering panelClass="dropDown-seasons-panel" id="month" formControlName="month" (selectionChange)="onMonthSelected()">
              <mat-option *ngFor="let option of monthOptions" [value]="option">
                {{option}}
              </mat-option>
            </mat-select> 
          </mat-form-field>
        </form>
        <a   style="cursor: pointer; text-decoration: underline;" (click)="exportReportTemplate()">File template</a>
        <app-upload class="w-100" (fileSelected)="onFileSelected($event)" [isMonthSelected]="isMonthSelected" [isTermSelected]="isTermSelected" [validName]="validFileName"></app-upload>
        <div class="buttons">
          <button class="preview-button" (click)="onImport()">
            <span>Preview</span>
          </button>
        </div>
      </mat-card>
    </div>
    <div class="col-md-12 col-lg-8">
      <mat-card class="preview-card">
        <h3 class="mb-3">Preview</h3>
        <div class="table">
          <table mat-table [dataSource]="dataSource" class="">
            <ng-container matColumnDef="expense">
              <th mat-header-cell *matHeaderCellDef> Expense </th>
              <td mat-cell *matCellDef="let element"> {{element.expenseName}} </td>
            </ng-container>
            <ng-container matColumnDef="costType">
              <th mat-header-cell *matHeaderCellDef> Cost Type </th>
              <td mat-cell *matCellDef="let element"> {{element.costType}} </td>
            </ng-container>
            <ng-container matColumnDef="unitPrice">
              <th mat-header-cell *matHeaderCellDef> Unit Price(VND) </th>
              <td mat-cell *matCellDef="let element"> {{element.unitPrice | number:'1.0-0'}} </td>
            </ng-container>
            <ng-container matColumnDef="amount">
              <th mat-header-cell *matHeaderCellDef> Amount </th>
              <td mat-cell *matCellDef="let element"> {{element.amount}} </td>
            </ng-container>
            <ng-container matColumnDef="total">
              <th mat-header-cell *matHeaderCellDef> Total(VND) </th>
              <td mat-cell *matCellDef="let element"> {{element.totalAmount| number:'1.0-0'}}  </td>
            </ng-container>
            <ng-container matColumnDef="projectName">
              <th mat-header-cell *matHeaderCellDef> Project Name </th>
              <td mat-cell *matCellDef="let element"> {{element.projectName}} </td>
            </ng-container>
            <ng-container matColumnDef="supplierName">
              <th mat-header-cell *matHeaderCellDef> Supplier Name </th>
              <td mat-cell *matCellDef="let element"> {{element.supplierName}} </td>
            </ng-container>
            <ng-container matColumnDef="pic">
              <th mat-header-cell *matHeaderCellDef> PIC </th>
              <td mat-cell *matCellDef="let element"> {{element.pic}} </td>
            </ng-container>
            <ng-container matColumnDef="notes">
              <th mat-header-cell *matHeaderCellDef> Notes </th>
              <td mat-cell *matCellDef="let element"> {{ element.note ? element.note : 'N/A' }} </td>
            </ng-container>
  
            <tr mat-header-row *matHeaderRowDef="columnHeaders"></tr>
            <tr mat-row *matRowDef="let row; columns: columnHeaders;"></tr>
          </table>
  
          <mat-paginator [length]="listSize" [pageSize]="pageSize" [pageIndex]="pageIndex" (page)="onPageChange($event)"
            [hidden]="dataSource.length==0 || (dataSource.length<pageSize && pageIndex==0)">
          </mat-paginator>
        </div>
        <div>
          <div class="buttons">
            <a [routerLink]="['/reports']">
              <button class="back-button">
                <span>Back</span>
              </button>
            </a>
            <button class="submit-button" [hidden]="!isPreview" (click)="onSubmit()">
              <span>Submit</span>
            </button>
          </div>
        </div>
      </mat-card>
    </div>
  </div>


</main>